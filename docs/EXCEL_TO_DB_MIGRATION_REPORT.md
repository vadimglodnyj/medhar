# –ó–≤—ñ—Ç –ø—Ä–æ –º—ñ–≥—Ä–∞—Ü—ñ—é –∑ Excel –Ω–∞ SQLite –ë–î

## ‚úÖ –í–∏–∫–æ–Ω–∞–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è

### 1. –û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ—î–∫—Ç—É

- **–°—Ç–≤–æ—Ä–µ–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π:**
  - `docs/` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —Ç–∞ –∑–≤—ñ—Ç–∏
  - `database/` - SQLite –±–∞–∑–∞ –¥–∞–Ω–∏—Ö
  - `import_scripts/` - —Å–∫—Ä–∏–ø—Ç–∏ —ñ–º–ø–æ—Ä—Ç—É
  - `startup_scripts/` - —Å–∫—Ä–∏–ø—Ç–∏ –∑–∞–ø—É—Å–∫—É
  - `scripts/` - –¥–æ–ø–æ–º—ñ–∂–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏

### 2. –Ü–º–ø–æ—Ä—Ç Excel ‚Üí SQLite –ë–î

- **–°—Ç–≤–æ—Ä–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç —ñ–º–ø–æ—Ä—Ç—É:** `import_scripts/import_all_excel_to_db.py`
- **–Ü–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ –¥–∞–Ω—ñ:**
  - üìä **13,958 –∑–∞–ø–∏—Å—ñ–≤ –ª—ñ–∫—É–≤–∞–Ω—å** –∑ Excel —Ñ–∞–π–ª—ñ–≤
  - üìã **2,573 –ø–∞—Ü—ñ—î–Ω—Ç–∏** –≤ –ë–î
  - üè• **248 –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤** –≤ –ë–î
  - üî¨ **13,411 –¥—ñ–∞–≥–Ω–æ–∑—ñ–≤** –≤ –ë–î
  - üí∞ **651 –≤–∏–ø–ª–∞—Ç–∞** –≤ –ë–î

### 3. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

- **–ó–º—ñ–Ω–µ–Ω–æ API —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** –∑ Excel –Ω–∞ SQLite –ë–î
- **–î–æ–¥–∞–Ω–æ –º–µ—Ç–æ–¥ `get_database_stats()`** –≤ `NewMedicalDatabase`
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ–ø–µ—Ä –ø–æ–∫–∞–∑—É—î:**
  - –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤ –ø–æ —Ç–∞–±–ª–∏—Ü—è—Ö
  - –î—ñ–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –ª—ñ–∫—É–≤–∞–Ω—å
  - –†–æ–∑–ø–æ–¥—ñ–ª –ø–æ —Ç–∏–ø–∞—Ö –ª—ñ–∫—É–≤–∞–Ω—å
  - –¢–æ–ø –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤

### 4. –û—á–∏—â–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É

- **–í–∏–¥–∞–ª–µ–Ω–æ –ø—Ä–æ–º—ñ–∂–Ω—ñ Excel —Ñ–∞–π–ª–∏:**
  - `treatments_adapted.xlsx`
  - `treatments_cleaned.xlsx`
  - `treatments_final_*.xlsx` (6 —Ñ–∞–π–ª—ñ–≤)
- **–ó–∞–ª–∏—à–µ–Ω–æ —Ç—ñ–ª—å–∫–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ñ–∞–π–ª–∏:**
  - `treatments_2024.xlsx` (14,546 –∑–∞–ø–∏—Å—ñ–≤)
  - `treatments_2025.xlsx` (8,482 –∑–∞–ø–∏—Å—ñ–≤)
  - `old_treatments.xlsx` (6,164 –∑–∞–ø–∏—Å—ñ–≤)

## üìä –ü–æ—Ç–æ—á–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ë–î

```
=== –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ë–î ===
total_patients: 2,573
total_units: 248
total_diagnoses: 13,411
total_treatments: 56,795
total_payments: 651
date_range: {'earliest': '2022-10-07', 'latest': 'NaT'}
treatment_types: {
  '–°—Ç–∞—Ü—ñ–æ–Ω–∞—Ä': 28,338,
  '–ê–º–±—É–ª–∞—Ç–æ—Ä–Ω–æ': 12,449,
  '–õ–∞–∑–∞—Ä–µ—Ç': 5,994,
  '–í—ñ–¥–ø—É—Å—Ç–∫–∞': 3,842,
  '–°—Ç–∞–±—ñ–ª—ñ–∑–∞—Ü—ñ–π–Ω–∏–π –ø—É–Ω–∫—Ç': 3,482,
  '–†–µ–∞–±—ñ–ª—ñ—Ç–∞—Ü—ñ—è': 2,122,
  '–î–µ–Ω–Ω–∏–π —Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä': 428,
  '–õ—ñ–∫—É–≤–∞–Ω–Ω—è –∑–∞ –∫–æ—Ä–¥–æ–Ω–æ–º': 97,
  '–í–õ–ö': 36
}
```

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –∑–º—ñ–Ω–∏

### 1. –û–Ω–æ–≤–ª–µ–Ω–æ `app.py`

- **–ó–º—ñ–Ω–µ–Ω–æ API `/api/stats`** - —Ç–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î SQLite –ë–î –∑–∞–º—ñ—Å—Ç—å Excel
- **–í–∏–¥–∞–ª–µ–Ω–æ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å** –≤—ñ–¥ `load_treatments_data()`

### 2. –†–æ–∑—à–∏—Ä–µ–Ω–æ `NewMedicalDatabase`

- **–î–æ–¥–∞–Ω–æ –º–µ—Ç–æ–¥ `get_database_stats()`** –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ë–î
- **–î–æ–¥–∞–Ω–æ –º–µ—Ç–æ–¥ `import_excel_data()`** –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É Excel
- **–î–æ–¥–∞–Ω–æ –¥–æ–ø–æ–º—ñ–∂–Ω—ñ –º–µ—Ç–æ–¥–∏:**
  - `_create_or_get_patient()`
  - `_create_or_get_unit()`
  - `_create_or_get_diagnosis()`
  - `_create_treatment()`

### 3. –°—Ç–≤–æ—Ä–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç —ñ–º–ø–æ—Ä—Ç—É

- **`import_scripts/import_all_excel_to_db.py`** - –ø–æ–≤–Ω–∏–π —ñ–º–ø–æ—Ä—Ç Excel ‚Üí SQLite
- **–ê–Ω–∞–ª—ñ–∑ Excel —Ñ–∞–π–ª—ñ–≤** –ø–µ—Ä–µ–¥ —ñ–º–ø–æ—Ä—Ç–æ–º
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è** –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
- **–î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è** –ø—Ä–æ—Ü–µ—Å—É —ñ–º–ø–æ—Ä—Ç—É

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

### ‚úÖ –î–æ—Å—è–≥–Ω—É—Ç–æ

1. **–ü–æ–≤–Ω–∞ –º—ñ–≥—Ä–∞—Ü—ñ—è** –∑ Excel –Ω–∞ SQLite –ë–î
2. **–û—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** –ø—Ä–æ—î–∫—Ç—É
3. **–†–æ–±–æ—á–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –∑ –ë–î
4. **–û—á–∏—â–µ–Ω–æ –ø—Ä–æ—î–∫—Ç** –≤—ñ–¥ –∑–∞–π–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤
5. **13,958 –∑–∞–ø–∏—Å—ñ–≤** —É—Å–ø—ñ—à–Ω–æ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ

### üìà –ü–µ—Ä–µ–≤–∞–≥–∏ –Ω–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏

- **–®–≤–∏–¥–∫—ñ—Å—Ç—å:** SQLite –Ω–∞–±–∞–≥–∞—Ç–æ —à–≤–∏–¥—à–∏–π –∑–∞ Excel
- **–ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å:** –°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∞ –ë–î –∑–∞–º—ñ—Å—Ç—å —Ñ–∞–π–ª—ñ–≤
- **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å:** –õ–µ–≥–∫–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ –¥–∞–Ω—ñ
- **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è:** –Ñ–¥–∏–Ω–∞ –ë–î –¥–ª—è –≤—Å—ñ—Ö —Ñ—É–Ω–∫—Ü—ñ–π
- **–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞:** –°–∫–ª–∞–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏ —Ç–∞ –∑–≤—ñ—Ç–∏

## üöÄ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É** - –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–±–æ—Ç—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ –≥–æ–ª–æ–≤–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ
2. **–ú—ñ–≥—Ä–∞—Ü—ñ—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫** - –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ –Ω–∞ –ë–î
3. **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è** - –¥–æ–¥–∞—Ç–∏ —ñ–Ω–¥–µ–∫—Å–∏ –¥–ª—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ
4. **–†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è** - –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –±–µ–∫-–∞–ø–∏ –ë–î

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É –ø—ñ—Å–ª—è –º—ñ–≥—Ä–∞—Ü—ñ—ó

```
medchar/
‚îú‚îÄ‚îÄ app.py                    # –ì–æ–ª–æ–≤–Ω–∏–π Flask –¥–æ–¥–∞—Ç–æ–∫
‚îú‚îÄ‚îÄ config.py                 # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îî‚îÄ‚îÄ medical_new.db        # SQLite –±–∞–∑–∞ –¥–∞–Ω–∏—Ö
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ PROJECT_STRUCTURE.md
‚îÇ   ‚îî‚îÄ‚îÄ EXCEL_TO_DB_MIGRATION_REPORT.md
‚îú‚îÄ‚îÄ import_scripts/
‚îÇ   ‚îî‚îÄ‚îÄ import_all_excel_to_db.py
‚îú‚îÄ‚îÄ startup_scripts/
‚îÇ   ‚îú‚îÄ‚îÄ run_medchar.bat
‚îÇ   ‚îú‚îÄ‚îÄ run_medchar.ps1
‚îÇ   ‚îî‚îÄ‚îÄ start_medchar.py
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ [–¥–æ–ø–æ–º—ñ–∂–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏]
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ new_medical_database.py
‚îî‚îÄ‚îÄ templates/
    ‚îî‚îÄ‚îÄ [HTML —à–∞–±–ª–æ–Ω–∏]
```

## ‚ú® –í–∏—Å–Ω–æ–≤–æ–∫

–ú—ñ–≥—Ä–∞—Ü—ñ—è –∑ Excel –Ω–∞ SQLite –ë–î —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—É—á–∞—Å–Ω—É —Ä–µ–ª—è—Ü—ñ–π–Ω—É –±–∞–∑—É –¥–∞–Ω–∏—Ö –∑–∞–º—ñ—Å—Ç—å Excel —Ñ–∞–π–ª—ñ–≤, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î –∫—Ä–∞—â—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å, –Ω–∞–¥—ñ–π–Ω—ñ—Å—Ç—å —Ç–∞ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è —Ä–æ–∑–≤–∏—Ç–∫—É.

