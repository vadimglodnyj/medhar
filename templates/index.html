{% extends "base.html" %} {% block title %}Головна - МедХар{% endblock %} {%
block content %}
<div class="container">
  <!-- Заголовок сторінки -->
  <div class="page-header text-center mb-5">
    <h1><i class="fas fa-hospital me-3"></i>МедХар</h1>
    <p class="lead">Система медичного обліку та генерації документів</p>
  </div>

  <!-- Статистика бази даних -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card bg-info text-white">
        <div class="card-body text-center">
          <h5 class="card-title">
            <i class="fas fa-database me-2"></i>Статистика бази даних
          </h5>
          <p class="card-text mb-0">
            <span id="stats-text">Завантаження...</span>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Основні функції -->
  <div class="row">
    <!-- Медична характеристика -->
    <div class="col-lg-4 col-md-6 mb-4">
      <div class="card feature-card h-100">
        <div class="card-body text-center">
          <div class="feature-icon text-primary">
            <i class="fas fa-file-medical"></i>
          </div>
          <h5 class="card-title">Медична характеристика</h5>
          <p class="card-text">
            Генерація медичної характеристики військовослужбовця на основі
            медичного обліку
          </p>
          <a href="/medical-characteristic" class="btn btn-primary">
            <i class="fas fa-arrow-right me-1"></i>Перейти
          </a>
        </div>
      </div>
    </div>

    <!-- Службова характеристика -->
    <div class="col-lg-4 col-md-6 mb-4">
      <div class="card feature-card h-100">
        <div class="card-body text-center">
          <div class="feature-icon text-success">
            <i class="fas fa-user-tie"></i>
          </div>
          <h5 class="card-title">Службова характеристика</h5>
          <p class="card-text">
            Створення службової характеристики з детальним описом службової
            діяльності
          </p>
          <a href="/service-characteristic" class="btn btn-success">
            <i class="fas fa-arrow-right me-1"></i>Перейти
          </a>
        </div>
      </div>
    </div>

    <!-- Рапорт ВЛК -->
    <div class="col-lg-4 col-md-6 mb-4">
      <div class="card feature-card h-100">
        <div class="card-body text-center">
          <div class="feature-icon text-danger">
            <i class="fas fa-clipboard-list"></i>
          </div>
          <h5 class="card-title">Рапорт ВЛК</h5>
          <p class="card-text">
            Генерація рапорту військово-лікарської комісії з результатами
            обстеження
          </p>
          <a href="/vlk-report" class="btn btn-danger">
            <i class="fas fa-arrow-right me-1"></i>Перейти
          </a>
        </div>
      </div>
    </div>

    <!-- Завантаження Excel файлів -->
    <div class="col-lg-4 col-md-6 mb-4">
      <div class="card feature-card h-100">
        <div class="card-body text-center">
          <div class="feature-icon text-info">
            <i class="fas fa-upload"></i>
          </div>
          <h5 class="card-title">Завантаження Excel файлів</h5>
          <p class="card-text">
            Ручне завантаження та обробка Excel файлів з медичними даними
          </p>
          <a href="/excel_upload" class="btn btn-info">
            <i class="fas fa-arrow-right me-1"></i>Перейти
          </a>
        </div>
      </div>
    </div>

    <!-- Виплати хворим -->
    <div class="col-lg-4 col-md-6 mb-4">
      <div class="card feature-card h-100">
        <div class="card-body text-center">
          <div class="feature-icon text-warning">
            <i class="fas fa-money-bill"></i>
          </div>
          <h5 class="card-title">Виплати хворим</h5>
          <p class="card-text">
            Аналіз та генерація звітів по виплатах за лікування
            військовослужбовців
          </p>
          <a href="/payment-reports" class="btn btn-warning">
            <i class="fas fa-arrow-right me-1"></i>Перейти
          </a>
        </div>
      </div>
    </div>

    <!-- Неоплачені стаціонари -->
    <div class="col-lg-4 col-md-6 mb-4">
      <div class="card feature-card h-100">
        <div class="card-body text-center">
          <div class="feature-icon text-danger">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <h5 class="card-title">Неоплачені стаціонари</h5>
          <p class="card-text">
            Звіт по неоплаченим стаціонарним лікуванням з можливістю генерації
            Excel
          </p>
          <a href="/unpaid-stationary" class="btn btn-outline-danger">
            <i class="fas fa-arrow-right me-1"></i>Перейти
          </a>
        </div>
      </div>
    </div>

    <!-- Додаткова інформація -->
    <div class="col-lg-4 col-md-6 mb-4">
      <div class="card feature-card h-100">
        <div class="card-body text-center">
          <div class="feature-icon text-info">
            <i class="fas fa-info-circle"></i>
          </div>
          <h5 class="card-title">Інформація</h5>
          <p class="card-text">
            Система працює з базою даних медичного обліку та автоматично генерує
            документи
          </p>
          <button class="btn btn-info" onclick="showSystemInfo()">
            <i class="fas fa-info me-1"></i>Детальніше
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Додаткова інформація (прихована) -->
  <div id="systemInfo" class="card mt-4" style="display: none">
    <div class="card-header">
      <h5 class="mb-0">
        <i class="fas fa-info-circle me-2"></i>Інформація про систему
      </h5>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <h6><i class="fas fa-database me-2"></i>База даних</h6>
          <ul class="list-unstyled">
            <li>
              <i class="fas fa-check text-success me-2"></i>SQLite база даних
            </li>
            <li>
              <i class="fas fa-check text-success me-2"></i>Нормалізована
              структура
            </li>
            <li>
              <i class="fas fa-check text-success me-2"></i>Автоматичний імпорт
              з Excel
            </li>
          </ul>
        </div>
        <div class="col-md-6">
          <h6><i class="fas fa-file-alt me-2"></i>Генерація документів</h6>
          <ul class="list-unstyled">
            <li>
              <i class="fas fa-check text-success me-2"></i>Word документи
              (.docx)
            </li>
            <li>
              <i class="fas fa-check text-success me-2"></i>Excel звіти (.xlsx)
            </li>
            <li>
              <i class="fas fa-check text-success me-2"></i>Шаблонна система
            </li>
          </ul>
        </div>
      </div>
      <div class="row mt-3">
        <div class="col-12">
          <h6><i class="fas fa-shield-alt me-2"></i>Функції системи</h6>
          <ul class="list-unstyled">
            <li>
              <i class="fas fa-check text-success me-2"></i>Автозаповнення даних
              з бази
            </li>
            <li>
              <i class="fas fa-check text-success me-2"></i>Пошук пацієнтів
            </li>
            <li>
              <i class="fas fa-check text-success me-2"></i>Аналіз оплат за
              лікування
            </li>
            <li>
              <i class="fas fa-check text-success me-2"></i>Звіти по неоплаченим
              стаціонарам
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script>
  // Завантаження статистики бази даних
  async function loadDatabaseStats() {
    try {
      const response = await fetch("/api/stats");
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      const stats = await response.json();
      if (stats.error) {
        document.getElementById("stats-text").textContent =
          "Помилка завантаження";
        return;
      }
      const totalRecords = stats.total_records ?? stats.total_treatments ?? 0;
      const uniquePatients = stats.unique_patients ?? stats.total_patients ?? 0;
      document.getElementById(
        "stats-text"
      ).textContent = `${totalRecords} записів, ${uniquePatients} унікальних пацієнтів`;
    } catch (error) {
      console.error("Помилка при завантаженні статистики:", error);
      document.getElementById("stats-text").textContent =
        "Помилка завантаження";
    }
  }

  // Показати/приховати додаткову інформацію
  function showSystemInfo() {
    const infoDiv = document.getElementById("systemInfo");
    if (infoDiv.style.display === "none") {
      infoDiv.style.display = "block";
    } else {
      infoDiv.style.display = "none";
    }
  }

  // Завантажуємо статистику при завантаженні сторінки
  document.addEventListener("DOMContentLoaded", loadDatabaseStats);
</script>
{% endblock %}
