#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π –º–µ–¥–∏—á–Ω–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É (Linux/macOS)

echo "üè• –í–°–¢–ê–ù–û–í–õ–ï–ù–ù–Ø –ú–ï–î–ò–ß–ù–û–ì–û –î–û–î–ê–¢–ö–£"
echo "=================================================="
echo

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —î Python
if ! command -v python3 &> /dev/null; then
    echo "‚ùå Python3 –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!"
    echo "–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å Python 3.8+ —Ç–∞ —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–Ω–æ–≤—É"
    exit 1
fi

echo "‚úÖ Python –∑–Ω–∞–π–¥–µ–Ω–æ"
python3 --version

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –≤–µ—Ä—Å—ñ—é Python
python_version=$(python3 -c 'import sys; print(".".join(map(str, sys.version_info[:2])))')
required_version="3.8"

if [ "$(printf '%s\n' "$required_version" "$python_version" | sort -V | head -n1)" != "$required_version" ]; then
    echo "‚ùå –ü–æ—Ç—Ä—ñ–±–µ–Ω Python 3.8 –∞–±–æ –Ω–æ–≤—ñ—à–∏–π!"
    echo "–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è: $python_version"
    exit 1
fi

echo
echo "üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π..."
echo

# –û–Ω–æ–≤–ª—é—î–º–æ pip
echo "üîÑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è pip..."
python3 -m pip install --upgrade pip

# –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
echo "üì• –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞–∫–µ—Ç—ñ–≤..."
python3 -m pip install -r requirements.txt

if [ $? -ne 0 ]; then
    echo "‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π!"
    exit 1
fi

echo
echo "üéâ –í–°–¢–ê–ù–û–í–õ–ï–ù–ù–Ø –ó–ê–í–ï–†–®–ï–ù–û!"
echo "=================================================="
echo "üìã –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:"
echo "1. –î–æ–¥–∞–π—Ç–µ –ø–∞–ø–∫—É 'data/' –∑ Excel —Ñ–∞–π–ª–∞–º–∏"
echo "2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥–æ–¥–∞—Ç–æ–∫: python3 app.py"
echo "3. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: http://127.0.0.1:5000"
echo "=================================================="
echo
